<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Data churn by AK - Essence of Matrix operations with Python</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" media="print" onload="this.media='all'">
<noscript>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
</noscript>



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="manifest" href="/assets/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#f0f0f0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Data churn by AK's App">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="msapplication-TileColor" content="#2d89ef">
  <meta name="msapplication-starturl" content="/">
  <meta name="application-name" content="Data churn by AK's App">
  <meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">

    <meta name="keywords" content="Math, Python, linear algebra, matrix, vector">

  <meta name="description" content="Matrix with Python">
  <meta name="robots" content="index, follow">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Essence of Matrix operations with Python">
<meta name="twitter:site" content="@amritkoirala1">
<meta name="twitter:description" content="Matrix with Python">
<meta name="twitter:image" content="http://localhost:4000/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/head.svg">
<meta property="og:site_name" content="Data churn by AK">
<meta property="og:type" content="article">
<meta property="og:title" content="Essence of Matrix operations with Python">
<meta property="og:description" content="Matrix with Python">
<meta property="og:url" content="http://localhost:4000/posts/2022-02-10-Matrix">
<meta property="og:image" content="http://localhost:4000/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/head.svg">
  <meta property="article:author" content="Amrit Koirala">
  <meta property="article:published_time" content="2022-01-31T17:11:06-06:00">
  <meta property="article:modified_time" content="2022-01-31T17:11:06-06:00">
  <meta property="article:section" content="Math">
  <meta property="article:tag" content="Python">
  <meta property="article:tag" content="linear algebra">
  <meta property="article:tag" content="matrix">
  <meta property="article:tag" content="vector">
  <script type="application/ld+json">{
  "@context": "https://schema.org"
  ,"@graph": [
    {
      "@type": "Person"
      ,"@id": "http://localhost:4000/#person"
      ,"name": "Amrit Koirala"
      ,"url": "http://localhost:4000/tabs/about.html"
      ,"image": "http://localhost:4000/assets/img/about/about.jpg"
      ,"description": "Data churn by AK is Amrit Koirala's journey in bioinformatics and data science."
  },{
    "@type": "WebSite"
    ,"@id": "http://localhost:4000/#website"
    ,"url": "http://localhost:4000/"
    ,"name": "Data churn by AK"
    ,"description": "Data churn by AK is Amrit Koirala's journey in bioinformatics and data science."
    ,"publisher": {"@id": "http://localhost:4000/#person"}
    ,"inLanguage": "en-US"
    ,"sameAs": ["https://www.github.com/akoirala2000","https://www.linkedin.com/in/amrit-koirala-41037392","https://www.twitter.com/amritkoirala1"]
    ,"copyrightHolder" : {"@id": "http://localhost:4000/#person"}
    ,"copyrightYear" : "2022"
  },{
    "@type": "WebPage"
    ,"@id": "http://localhost:4000/posts/2022-02-10-Matrix#webpage"
    ,"url": "http://localhost:4000/posts/2022-02-10-Matrix"
    ,"name": "Essence of Matrix operations with Python"
    ,"isPartOf": {"@id": "http://localhost:4000/#website"}
    ,"breadcrumb": {"@id": "http://localhost:4000/posts/2022-02-10-Matrix#breadcrumb"}
    ,"primaryImageOfPage": "http://localhost:4000/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/head.svg"
    ,"datePublished": "2022-01-31T17:11:06-06:00"
    ,"dateModified": "2022-01-31T17:11:06-06:00"
    ,"description": "Matrix with Python"
    ,"inLanguage": "en-US"
    ,"potentialAction": {
      "@type": "ReadAction"
      ,"target": "http://localhost:4000/posts/2022-02-10-Matrix"
    }
  },{
      "@type": "BreadcrumbList",
      "@id": "http://localhost:4000/posts/2022-02-10-Matrix#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem"
          ,"position": 1
          ,"name": "Home"
          ,"item": "http://localhost:4000/"
        },
        {
          "@type": "ListItem"
          ,"position": 2
          ,"name": "Notes"
          ,"item": "http://localhost:4000/tabs/blog/"
        },
        {
          "@type": "ListItem"
          ,"position": 3
          ,"name": "Essence of Matrix operations with Python"
        }
      ]
    },{
      "@type": "BlogPosting"
      ,"@id": "http://localhost:4000/posts/2022-02-10-Matrix#content"
      ,"isPartOf": {"@id": "http://localhost:4000/posts/2022-02-10-Matrix#webpage"}
      ,"mainEntityOfPage": {"@id": "http://localhost:4000/posts/2022-02-10-Matrix#webpage"}
      ,"publisher": {"@id": "http://localhost:4000/#person"}
      ,"author": {"@id": "http://localhost:4000/#person"}
      ,"inLanguage": "en-US"
      ,"headline": "Essence of Matrix operations with Python"
      ,"image": "http://localhost:4000/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/head.svg"
      ,"thumbnailUrl": "http://localhost:4000/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/head.svg"
      ,"datePublished": "2022-01-31T17:11:06-06:00"
      ,"dateModified": "2022-01-31T17:11:06-06:00"
      ,"articleSection": ["Math", "Python", "linear algebra", "matrix", "vector"]
      ,"description": "Matrix with Python"
      ,"copyrightHolder" : {"@id": "http://localhost:4000/#person"}
      ,"copyrightYear" : "2022"
      ,"wordCount": 1701
      ,"articleBody": "Linear Algebra in Data Science Vectors and matrices are heavily used in computer science (and data science) to store and perform multiple mathematical operations on a data set.Although, the concept of vector as used in physics (example a quantity with both magnitude and direction (2 dimensional vector)) and vector used in computers (example list of features recorded on a observation) have very different meanings in real life, when performing mathematical operations, both of these vectors follow same rules. Therefore, the branch of discrete mathematics, that deal with manipulation of vectors has applications in diverse fields like computer programming, storing big data set, cryptography, image editing, graph theory and many more. Hence, a through understanding of fundamental concepts of vectors and matrix operation is necessary to understand multiple algorithms used in data science. In in this article, I am trying to highlight the importance of vectors and matrices in data science by showing some matrix and vector operations in Python. ( Code in R and data used are available here.) Vectors In data science, any list of values is a vector and as long as the manipulations on this list follows linear operations (not exponential or higher order transformations), the theories of linear algebra can be used to perform complex calculations. For example to store a 28X28 pixel gray scale image in a computer, we can make a 28*28=784 dimensional vector which will hold values for intensity of black at each pixel. Following code chuck in Python reads a csv holding such data for images of 150 handwritten letters one letter per row. ##load necessary modules import pandas as pd import numpy as np import matplotlib.pyplot as plt #Read handwriting data set Handwriting = pd.read_csv(\"DigitMatrix.csv\") print(\"Summary of DataFrame \" ) ## Summary of DataFrame Handwriting.describe() ## y X1 X2 X3 ... X781 X782 X783 X784 ## count 150.000000 150.0 150.0 150.0 ... 150.0 150.0 150.0 150.0 ## mean 4.000000 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 ## std 2.953783 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 ## min 0.000000 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 ## 25% 0.000000 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 ## 50% 5.000000 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 ## 75% 7.000000 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 ## max 7.000000 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 ## ## [8 rows x 785 columns] print(\"The first column is the label of these digits and below is the frequecy distribution \") ## The first column is the label of these digits and below is the frequecy distribution Handwriting['y'].value_counts() #Make a DataFrame excluding labels ## 7 50 ## 0 50 ## 5 50 ## Name: y, dtype: int64 Handwriting_matrix = Handwriting.iloc[:,1:786] print(\"View of a single vector in this data set\") ## View of a single vector in this data set Handwriting_matrix.iloc[1] ## X1 0 ## X2 0 ## X3 0 ## X4 0 ## X5 0 ## .. ## X780 0 ## X781 0 ## X782 0 ## X783 0 ## X784 0 ## Name: 1, Length: 784, dtype: int64 This view of first row in this handwriting_matrix shows a representation of familiar column vector which has 784 dimensions. #visualize some examples print(\"Visualization of some example images\") ## Visualization of some example images fig, (ax0, ax1, ax2) = plt.subplots(ncols=3) ax0.imshow((np.array(Handwriting_matrix.iloc[1])).reshape(28,28), cmap=\"binary\") ax1.imshow((np.array(Handwriting_matrix.iloc[55])).reshape(28,28), cmap=\"binary\") ax2.imshow((np.array(Handwriting_matrix.iloc[105])).reshape(28,28), cmap=\"binary\") fig.tight_layout() plt.show() The figure above shows three example images from 150 images present in this handwriting data. Each row in this dataframe can be considered a vector of 784 dimensions. Vector addition and scalar multiplication Lets consider a situation, How can we find average intensity of each pixel for each of these three digits ? Instead of finding aveage of one pixel at time, we can perform simple vector addition of all 50 vectors and divide the sum vector by the total number of images(50) of that category. This operations is just the extension to 784 dimensions of simple vector addition and scalar multiplication illustrated by 2 dimensional vectors below: \\[Sum(u,v)= \\begin{bmatrix}a \\\\ b \\end{bmatrix} +\\begin{bmatrix}c \\\\ d \\end{bmatrix}=\\begin{bmatrix}a+c \\\\ b+d \\end{bmatrix}\\] \\[k*u= \\begin{bmatrix}ka \\\\ kb \\end{bmatrix}\\] Vector addition and multiplication performed in Python to find average pixel intesity for each digit. #Find average of each pixel for each category of number Sum_Sevens= (Handwriting_matrix.iloc[0:50]).sum(0) Average_Sevens= Sum_Sevens*1/50 #Can also use mean function in pandas Average_zeros= Handwriting_matrix.iloc[50:100].mean(0) Average_fives= Handwriting_matrix.iloc[100:150].mean(0) #Visualize the average pixel for each category fig, (ax0, ax1, ax2) = plt.subplots(ncols=3) ax0.imshow((np.array(Average_Sevens)).reshape(28,28), cmap=\"binary\") ax1.imshow((np.array(Average_zeros)).reshape(28,28), cmap=\"binary\") ax2.imshow((np.array(Average_fives)).reshape(28,28), cmap=\"binary\") fig.tight_layout() plt.show() Vector subtraction Subtraction of vectors can be performed similar to vector addition, by subtracting each item of second vector from the first vector. \\[Subtraction(u,v)= \\begin{bmatrix}a \\\\ b \\end{bmatrix} -\\begin{bmatrix}c \\\\ d \\end{bmatrix}=\\begin{bmatrix}a-c \\\\ b-d \\end{bmatrix}\\] To see some examples of vector subtraction lets consider only one example of image from our 150 images above. A single digit image is composed of 784 pixels and location of each of these pixels in Cartesian coordinate can be represented by a 2d vector where the first row corresponds to x-coordinate and second row corresponds to y-coordinate. In order to completely describe each pixel we need to add a 3rd dimension to our pixel vector which will hold the value of intensity of black. Remember this 3rd dimension has nothing to do with the 3d dimension in space, vector dimensions in computer science keeps on increasing as new information is collected about that vector. For example if each of these pixels were RGB colored pixels in addition to x,y coordinates, there would be 3 more dimensions one each for R, G and B value, making each pixel a 5-dimensional vector. The code chuck below shows how a image can be represented by 874 vectors of dimensions = 3. #Take a image with row index = 105 SingleImage = np.array(Handwriting_matrix.iloc[105, :]) Vectors = pd.DataFrame({\"x\":np.tile(np.arange(1,29),28), # 1st dim is x-coordinate \"y\":np.repeat(np.arange(28,0,-1),28), #2nd dim is y-coordinate \"z\":SingleImage.ravel()}) #3rd dim is intensity of black Vectors.describe() #write a function to visualize these 784 vectors ## x y z ## count 784.000000 784.000000 784.000000 ## mean 14.500000 14.500000 26.001276 ## std 8.082904 8.082904 69.831479 ## min 1.000000 1.000000 0.000000 ## 25% 7.750000 7.750000 0.000000 ## 50% 14.500000 14.500000 0.000000 ## 75% 21.250000 21.250000 0.000000 ## max 28.000000 28.000000 255.000000 def DigitImage(df): fig, ax = plt.subplots() ax.grid() ax.axhline(y=0) ax.axvline(x=0) ax.scatter(\"x\",\"y\", data=df, c=\"z\", marker=\"s\", cmap= \"YlOrRd\", vmin=0, vmax=255) ax.set_xlim(left=-28, right=28) ax.set_ylim(bottom=-28, top= 28) ax.set_axisbelow(True) plt.show() DigitImage(Vectors) The figure above is generated by plotting 784 points (shaped square to mimic square pixels) and color intensity mapped to a color gradient from yellow to red (yellow= 0, red= 255). Hence each of the square is a vector of 3 dimensions. Now, if we want to move this image so that it is centered at origin we need to perform some vector subtraction. The vector \\(\\begin{bmatrix}14 \\\\ 14 \\\\249 \\end{bmatrix}\\) is the midpoint of this image (shown in the image below). If we subtract this vector from all 784 vectors the image should be centered at origin. fig, ax = plt.subplots() ax.grid() ax.axhline(y=0) ax.axvline(x=0) ax.scatter(\"x\",\"y\", data=Vectors, c=\"z\", marker=\"s\", cmap= \"YlOrRd\", vmin=0, vmax=255) ax.arrow(0,0,14,14, width=0.3, length_includes_head=True, color='black') ax.text(14,14, \" Vector [14,14,249]\", color=\"blue\") ax.set_xlim(left=-28, right=28) ## (-28.0, 28.0) ax.set_ylim(bottom=-28, top= 28) ## (-28.0, 28.0) ax.set_axisbelow(True) plt.show() The figure above show the pixel that occur at the center of this image as an arrow. Now the transformation of this image to the center can be represented as a vector subtraction as below: \\[\\text{Transform to origin}= \\begin{bmatrix}x \\\\ y \\\\z \\end{bmatrix} -\\begin{bmatrix}14 \\\\ 14 \\\\0 \\end{bmatrix}=\\begin{bmatrix}x-14 \\\\ y-14 \\\\z-0 \\end{bmatrix}\\] Centered = Vectors.apply(lambda x: (x) - [14,14,0], axis=1,) DigitImage(Centered) Matrix The simplest definition of a matrix is, it is collection of vectors. For example the identity matrix for a 2d vector is: \\[\\begin{pmatrix} 1 &amp; 0 \\\\0 &amp;1 \\end{pmatrix}\\] Here the first and second columns are simply the basis vector in x-direction and y-direction after the transformation by this matrix. Since this is matrix that does not bring about any transformation both columns are same as the original basis vectors of this system. The matrix multiplication with vector is formulated in such a way that when a matrix is multiplied with the transformation matrix it is transformed according the values of new basis vector coded in the matrix. Skew The following matrix can skew the image by 45 degree towards left without making any change to the 3rd dimension which stores information for color. \\[\\begin{pmatrix} 1 &amp; -1 &amp;0 \\\\0 &amp;1 &amp;0\\\\0&amp;0&amp;1 \\end{pmatrix}\\] The basis on x-direction is unchanged while for basis in y-direction now has a x-component of -1. ##write a function which takes df and matrix and gives transformed df def matrixTrans(Df, matrix): Transformed =pd.DataFrame(np.matmul(matrix, pd.DataFrame.to_numpy(Df).transpose() )) Transformed = Transformed.transpose() Transformed.columns = ['x','y','z'] return(Transformed) mat1=np.array([[1, -1, 0], [0, 1, 0], [0, 0, 1]]) VecTrans = matrixTrans(Centered, mat1) DigitImage(VecTrans) Skew in y direction import math mat1=np.array([[1, 0, 0], [-1, 1, 0], [0, 0, 1]]) VecTrans = matrixTrans(Centered, mat1) DigitImage(VecTrans) Rotation 45 counterclockwise import math mat1=np.array([[math.cos(45),-math.sin(45),0], [math.sin(45), math.cos(45), 0], [0, 0, 1]]) VecTrans = matrixTrans(Centered, mat1) DigitImage(VecTrans) #### Rotation 90 counterclockwise import math mat1=np.array([[math.cos(90),-math.sin(90),0], [math.sin(90), math.cos(90), 0], [0, 0, 1]]) VecTrans = matrixTrans(Centered, mat1) DigitImage(VecTrans) Flip along y-axis mat1=np.array([[-1,0,0], [0, 1, 0], [0, 0, 1]]) VecTrans = matrixTrans(Centered, mat1) DigitImage(VecTrans) Flip along x-axis mat1=np.array([[1,0,0], [0, -1, 0], [0, 0, 1]]) VecTrans = matrixTrans(Centered, mat1) DigitImage(VecTrans) Decrease color intensity by 50% mat1=np.array([[1,0,0], [0, 1, 0], [0, 0, 0.5]]) VecTrans = matrixTrans(Centered, mat1) DigitImage(VecTrans) Matrix multiplication Matrix multiplication is simply a way to represent a sequence of transformation. For example \\(B.A\\) , simply represents apply transformation by A first and then B. This step by step transformation will give same result at apply transformation by BA. For example lets first flip the letter along y-axis and then apply skew left. #Flip mat1=np.array([[-1,0,0], [0, 1, 0], [0, 0, 1]]) #skew left mat2=np.array([[1,-1,0], [0, 1, 0], [0, 0, 1]]) VecTrans = matrixTrans(Centered, mat1) VecTrans2= matrixTrans(VecTrans, mat2) DigitImage(VecTrans2) #Flip mat1=np.array([[-1,0,0], [0, 1, 0], [0, 0, 1]]) #skew left mat2=np.array([[1,-1,0], [0, 1, 0], [0, 0, 1]]) comb = np.matmul(mat2,mat1) VecTrans = matrixTrans(Centered, comb) DigitImage(VecTrans) Inverse matrix This is the matrix which will revert the transformation caused by its complementary matrix. #inverse of comb matrix above is invMat = np.linalg.inv(comb) #apply this inv transformation to VecTrans Orig = matrixTrans(VecTrans, invMat) DigitImage(Orig)"
    }
  ]
}</script>


<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<link href="/assets/css/main.css" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v0.4.1/dist/bootstrap-toc.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.css">
<link href="/assets/css/nav-media.css" rel="stylesheet">

  </head>

  <body >
    <script src="/assets/js/color-scheme-attr-init.js" data-mode="false"></script>
    <nav class="navbar navbar-default top-nav">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed pull-left top-nav-menu-toggle" data-toggle="collapse" data-target="#id_top-nav-menu-toggle" aria-expanded="false">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand top-nav-brand" href="/" translate="no">Data churn by AK</a>
    </div>
  <div class="color_scheme_switch_top_holder" data-toggle="tooltip" data-placement="bottom" title="Color scheme">
  <label class="color-scheme-switch hover-effect">
    <input type="checkbox" class="checkbox_color_switch" />
    <span></span>
  </label>
</div>

  
</nav>
<nav id="side-nav-container">
  <div class="side-nav">
    <div class="side-nav-brand">
      <img src="/assets/img/default/profile.jpg" alt="">
      <div class="brand-holder">
        <a href="/" translate="no">Data churn by AK</a>
        </div>
      <p>&nbsp;Data blogs</p>
      <br>
    </div>
    <br>
    <a href="javascript:void(0);" class="side-nav-close">
        <i class="fa fa-angle-double-left fa-2x" aria-hidden="true"></i>
      </a>
    <hr>
    <br>
    <div class="side-nav-buttons">
      <ul class="nav nav-pills nav-stacked">
        <li ><a href="/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/tabs/blog/" class="active-page hover-effect"><i class="fa-fw fa fa-pencil-square-o" aria-hidden="true"></i>Notes</a></li><li ><a href="/tabs/archive.html" class=" hover-effect"><i class="fa-fw fa fa-archive" aria-hidden="true"></i>Archive</a></li><li ><a href="/tabs/projects.html" class=" hover-effect"><i class="fa-fw fa fa-book" aria-hidden="true"></i>Notebooks</a></li><li ><a href="/tabs/links.html" class=" hover-effect"><i class="fa-fw fa fa-link" aria-hidden="true"></i>Links</a></li><li ><a href="/tabs/about.html" class=" hover-effect"><i class="fa-fw fa fa-user-o" aria-hidden="true"></i>About</a></li></ul>
    </div>
    <br>
    <br><div class="contact-container">
  <hr>
  <h3>Contact</h3>
  <ul><li><a href="https://www.github.com/akoirala2000" class="hover-effect-big" target="_blank" rel="noopener noreferrer"><i class="fa fa-github" aria-hidden="true"></i></a></li><li>
      <a href="javascript:void(0);" class="hover-effect-big" onclick="setAddress('datachurnbyak', 'gmail.com');"><i class="fa fa-envelope-o" aria-hidden="true"></i></a></li><li><a href="https://www.linkedin.com/in/amrit-koirala-41037392" class="hover-effect-big" target="_blank" rel="noopener noreferrer"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a href="https://www.twitter.com/amritkoirala1" class="hover-effect-big" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter" aria-hidden="true"></i></a></li></ul>
</div>

    <hr id="toc-view-top">
    <div class="side-nav-footer" translate="no">
        <p>&copy; 2022 Data churn by AK.</p>
      </div>
  </div>
  <div class="side-nav-bottom-buttons-container">
    <hr>
    <ul>
      <li><div class="color_scheme_switch_side_holder" data-toggle="tooltip" data-placement="top" title="Color scheme">
  <label class="color-scheme-switch hover-effect">
    <input type="checkbox" class="checkbox_color_switch" />
    <span></span>
  </label>
</div>
</li><li><div class="cookie-icon hover-effect" onclick="CookieConsent.showSettings();" data-toggle="tooltip" data-placement="top" title="Cookie settings">
  <div class="cookie-wrapper">
    <i class="fa fa-circle bitten-cookie" aria-hidden="true"></i>
    <i class="fa fa-circle small-ellipse-icon" aria-hidden="true"></i>
    <i class="fa fa-spinner inner-icon" aria-hidden="true"></i>
    <i class="fa fa-circle-thin outer-icon" aria-hidden="true"></i>
  </div>
</div>
</li></ul>
  </div></nav>
<div id="toc-container" class="movable">
  <div class="panel panel-default">
    <div class="panel-heading" data-toggle="tooltip" data-placement="top" title="Drag to move">
      Contents
      <span class="pull-right">
        <a href="javascript:void(0);" class="close-button" onclick="document.getElementById('toc-container').style.display = 'none';">
          <i class="fa fa-times" data-toggle="tooltip" data-placement="bottom" title="Close"></i>
        </a>
      </span>
    </div>
    <div class="panel-body">
      <nav id="table-of-contents"></nav>
    </div>
  </div>
</div>
<div id="main-wrapper">
      <div class="main-container"><div class="multipurpose-container post-container">
  <div class="post-title">Essence of Matrix operations with Python</div><div class="meta">
  <small>
    &nbsp;<i class="fa fa-calendar"></i>&nbsp;&nbsp;Jan 31, 2022
  </small>
  <small>
    &nbsp;&nbsp;&nbsp;<span><i class="fa fa-clock-o"></i>&nbsp;13 min read</span>
  </small>
  
  <small class="meta-link" >
    &nbsp;&nbsp;&nbsp;<i class="fa fa-comments-o"></i>&nbsp;<a href="/posts/2022-02-10-Matrix#disqus_thread">-</a>
    <a href="javascript:void(0);" onclick="window.location.href='/posts/2022-02-10-Matrix#disqus_thread'">Comments</a>
  </small>
  </div>
<hr/>
  <div class="markdown-style">
    <h3 id="linear-algebra-in-data-science">Linear Algebra in Data Science</h3>
<!-- outline-start -->
<p>Vectors and matrices are heavily used in computer science (and data
science) to store and perform multiple mathematical operations on a data
set.Although, the concept of vector as used in physics (example a
quantity with both magnitude and direction (2 dimensional vector)) and
vector used in computers (example list of features recorded on a
observation) have very different meanings in real life, when performing
mathematical operations, both of these vectors follow same rules.<!-- outline-end -->
Therefore, the branch of discrete mathematics, that deal with
manipulation of vectors has applications in diverse fields like computer
programming, storing big data set, cryptography, image editing, graph
theory and many more. Hence, a through understanding of fundamental
concepts of vectors and matrix operation is necessary to understand
multiple algorithms used in data science. In in this article, I am
trying to highlight the importance of vectors and matrices in data
science by showing some matrix and vector operations in Python. ( Code
in R and data used are available here.)</p>

<h3 id="vectors">Vectors</h3>

<p>In data science, any list of values is a vector and as long as the
manipulations on this list follows linear operations (not exponential or
higher order transformations), the theories of linear algebra can be
used to perform complex calculations. For example to store a 28X28 pixel
gray scale image in a computer, we can make a 28*28=784 dimensional
vector which will hold values for intensity of black at each pixel.
Following code chuck in Python reads a csv holding such data for images
of 150 handwritten letters one letter per row.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##load necessary modules 
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1">#Read handwriting data set
</span><span class="n">Handwriting</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"DigitMatrix.csv"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Summary of DataFrame "</span> <span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Summary of DataFrame
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Handwriting</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##                 y     X1     X2     X3  ...   X781   X782   X783   X784
## count  150.000000  150.0  150.0  150.0  ...  150.0  150.0  150.0  150.0
## mean     4.000000    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0
## std      2.953783    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0
## min      0.000000    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0
## 25%      0.000000    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0
## 50%      5.000000    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0
## 75%      7.000000    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0
## max      7.000000    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0
## 
## [8 rows x 785 columns]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"The first column is the label of these digits and below is the frequecy distribution "</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## The first column is the label of these digits and below is the frequecy distribution
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Handwriting</span><span class="p">[</span><span class="s">'y'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1">#Make a DataFrame excluding labels 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 7    50
## 0    50
## 5    50
## Name: y, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Handwriting_matrix</span> <span class="o">=</span> <span class="n">Handwriting</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">786</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="s">"View of a single vector in this data set"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## View of a single vector in this data set
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Handwriting_matrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## X1      0
## X2      0
## X3      0
## X4      0
## X5      0
##        ..
## X780    0
## X781    0
## X782    0
## X783    0
## X784    0
## Name: 1, Length: 784, dtype: int64
</code></pre></div></div>

<p>This view of first row in this handwriting_matrix shows a representation
of familiar column vector which has 784 dimensions.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#visualize some examples 
</span><span class="k">print</span><span class="p">(</span><span class="s">"Visualization of some example images"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Visualization of some example images
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax0</span><span class="p">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">Handwriting_matrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">])).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"binary"</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">Handwriting_matrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">55</span><span class="p">])).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"binary"</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">Handwriting_matrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">105</span><span class="p">])).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"binary"</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-2-1.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-2-1.svg" alt="" /></p>

<p>The figure above shows three example images from 150 images present in
this handwriting data. Each row in this dataframe can be considered a
vector of 784 dimensions.</p>

<h3 id="vector-addition-and-scalar-multiplication">Vector addition and scalar multiplication</h3>

<p>Lets consider a situation, How can we find average intensity of each
pixel for each of these three digits ? Instead of finding aveage of one
pixel at time, we can perform simple vector addition of all 50 vectors
and divide the sum vector by the total number of images(50) of that
category. This operations is just the extension to 784 dimensions of
simple vector addition and scalar multiplication illustrated by 2
dimensional vectors below:</p>

\[Sum(u,v)= \begin{bmatrix}a \\ b \end{bmatrix} +\begin{bmatrix}c \\ d \end{bmatrix}=\begin{bmatrix}a+c \\ b+d \end{bmatrix}\]

\[k*u= \begin{bmatrix}ka \\ kb \end{bmatrix}\]

<p>Vector addition and multiplication performed in Python to find average
pixel intesity for each digit.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Find average of each pixel for each category of number
</span><span class="n">Sum_Sevens</span><span class="o">=</span>  <span class="p">(</span><span class="n">Handwriting_matrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">]).</span><span class="nb">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Average_Sevens</span><span class="o">=</span> <span class="n">Sum_Sevens</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="mi">50</span>

<span class="c1">#Can also use mean function in pandas
</span><span class="n">Average_zeros</span><span class="o">=</span> <span class="n">Handwriting_matrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">].</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Average_fives</span><span class="o">=</span> <span class="n">Handwriting_matrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">150</span><span class="p">].</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">#Visualize the average pixel for each category
</span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax0</span><span class="p">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">Average_Sevens</span><span class="p">)).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"binary"</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">Average_zeros</span><span class="p">)).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"binary"</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">Average_fives</span><span class="p">)).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"binary"</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-3-3.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-3-3.svg" alt="" /></p>

<h3 id="vector-subtraction">Vector subtraction</h3>

<p>Subtraction of vectors can be performed similar to vector addition, by
subtracting each item of second vector from the first vector.</p>

\[Subtraction(u,v)= \begin{bmatrix}a \\ b \end{bmatrix} -\begin{bmatrix}c \\ d \end{bmatrix}=\begin{bmatrix}a-c \\ b-d \end{bmatrix}\]

<p>To see some examples of vector subtraction lets consider only one
example of image from our 150 images above. A single digit image is
composed of 784 pixels and location of each of these pixels in Cartesian
coordinate can be represented by a 2d vector where the first row
corresponds to x-coordinate and second row corresponds to y-coordinate.
In order to completely describe each pixel we need to add a 3rd
dimension to our pixel vector which will hold the value of intensity of
black. Remember this 3rd dimension has nothing to do with the 3d
dimension in space, vector dimensions in computer science keeps on
increasing as new information is collected about that vector. For
example if each of these pixels were RGB colored pixels in addition to
x,y coordinates, there would be 3 more dimensions one each for R, G and
B value, making each pixel a 5-dimensional vector.</p>

<p>The code chuck below shows how a image can be represented by 874 vectors
of dimensions = 3.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Take a image with row index = 105
</span><span class="n">SingleImage</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">Handwriting_matrix</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">105</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">Vectors</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">"x"</span><span class="p">:</span><span class="n">np</span><span class="p">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">29</span><span class="p">),</span><span class="mi">28</span><span class="p">),</span> <span class="c1"># 1st dim is x-coordinate
</span>                        <span class="s">"y"</span><span class="p">:</span><span class="n">np</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">28</span><span class="p">),</span> <span class="c1">#2nd dim is y-coordinate
</span>                        <span class="s">"z"</span><span class="p">:</span><span class="n">SingleImage</span><span class="p">.</span><span class="n">ravel</span><span class="p">()})</span> <span class="c1">#3rd dim is intensity of black
</span>                        
<span class="n">Vectors</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
<span class="c1">#write a function to visualize these 784 vectors 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##                 x           y           z
## count  784.000000  784.000000  784.000000
## mean    14.500000   14.500000   26.001276
## std      8.082904    8.082904   69.831479
## min      1.000000    1.000000    0.000000
## 25%      7.750000    7.750000    0.000000
## 50%     14.500000   14.500000    0.000000
## 75%     21.250000   21.250000    0.000000
## max     28.000000   28.000000  255.000000
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">DigitImage</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">"x"</span><span class="p">,</span><span class="s">"y"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">"z"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">"s"</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span> <span class="s">"YlOrRd"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=-</span><span class="mi">28</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="mi">28</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span> <span class="mi">28</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    
<span class="n">DigitImage</span><span class="p">(</span><span class="n">Vectors</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-4-5.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-4-5.svg" alt="" />
The figure above is generated by plotting 784 points (shaped square to
mimic square pixels) and color intensity mapped to a color gradient from
yellow to red (yellow= 0, red= 255). Hence each of the square is a
vector of 3 dimensions.</p>

<p>Now, if we want to move this image so that it is centered at origin we
need to perform some vector subtraction. The vector
\(\begin{bmatrix}14 \\ 14 \\249 \end{bmatrix}\) is the midpoint of this
image (shown in the image below). If we subtract this vector from all
784 vectors the image should be centered at origin.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">"x"</span><span class="p">,</span><span class="s">"y"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">Vectors</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">"z"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">"s"</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span> <span class="s">"YlOrRd"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'black'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span> <span class="s">" Vector [14,14,249]"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"blue"</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=-</span><span class="mi">28</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (-28.0, 28.0)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="mi">28</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span> <span class="mi">28</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## (-28.0, 28.0)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span><span class="p">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-5-7.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-5-7.svg" alt="" /></p>

<p>The figure above show the pixel that occur at the center of this image
as an arrow. Now the transformation of this image to the center can be
represented as a vector subtraction as below:</p>

\[\text{Transform to origin}= \begin{bmatrix}x \\ y \\z \end{bmatrix} -\begin{bmatrix}14 \\ 14 \\0 \end{bmatrix}=\begin{bmatrix}x-14 \\ y-14 \\z-0 \end{bmatrix}\]

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Centered</span> <span class="o">=</span> <span class="n">Vectors</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span>
<span class="n">DigitImage</span><span class="p">(</span><span class="n">Centered</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-6-9.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-6-9.svg" alt="" /></p>

<h3 id="matrix">Matrix</h3>

<p>The simplest definition of a matrix is, it is collection of vectors. For
example the identity matrix for a 2d vector is:</p>

\[\begin{pmatrix} 1 &amp; 0 \\0 &amp;1 \end{pmatrix}\]

<p>Here the first and second columns are simply the basis vector in
x-direction and y-direction after the transformation by this matrix.
Since this is matrix that does not bring about any transformation both
columns are same as the original basis vectors of this system. The
matrix multiplication with vector is formulated in such a way that when
a matrix is multiplied with the transformation matrix it is transformed
according the values of new basis vector coded in the matrix.</p>

<h4 id="skew">Skew</h4>

<p>The following matrix can skew the image by 45 degree towards left
without making any change to the 3rd dimension which stores information
for color.</p>

\[\begin{pmatrix} 1 &amp; -1 &amp;0 \\0 &amp;1 &amp;0\\0&amp;0&amp;1 \end{pmatrix}\]

<p>The basis on x-direction is unchanged while for basis in y-direction now
has a x-component of -1.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##write a function which takes df and matrix and gives transformed df
</span><span class="k">def</span> <span class="nf">matrixTrans</span><span class="p">(</span><span class="n">Df</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
    <span class="n">Transformed</span> <span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">Df</span><span class="p">).</span><span class="n">transpose</span><span class="p">()</span> <span class="p">))</span>
    <span class="n">Transformed</span> <span class="o">=</span> <span class="n">Transformed</span><span class="p">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">Transformed</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'x'</span><span class="p">,</span><span class="s">'y'</span><span class="p">,</span><span class="s">'z'</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Transformed</span><span class="p">)</span>

<span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">mat1</span><span class="p">)</span>    

<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-7-11.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-7-11.svg" alt="" /></p>

<h4 id="skew-in-y-direction">Skew in y direction</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">math</span>
<span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">mat1</span><span class="p">)</span>    

<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-8-13.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-8-13.svg" alt="" /></p>

<h4 id="rotation-45-counterclockwise">Rotation 45 counterclockwise</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">math</span>
<span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="n">math</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span><span class="o">-</span><span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="n">math</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">mat1</span><span class="p">)</span>    

<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-9-15.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-9-15.svg" alt="" />
#### Rotation 90 counterclockwise</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">math</span>
<span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="n">math</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span><span class="o">-</span><span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="n">math</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span> <span class="n">math</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">mat1</span><span class="p">)</span>    

<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-10-17.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-10-17.svg" alt="" /></p>

<h4 id="flip-along-y-axis">Flip along y-axis</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">mat1</span><span class="p">)</span>    

<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-11-19.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-11-19.svg" alt="" /></p>

<h4 id="flip-along-x-axis">Flip along x-axis</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">mat1</span><span class="p">)</span>    

<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-12-21.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-12-21.svg" alt="" /></p>

<h4 id="decrease-color-intensity-by-50">Decrease color intensity by 50%</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">mat1</span><span class="p">)</span>    

<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-13-23.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-13-23.svg" alt="" /></p>

<h3 id="matrix-multiplication">Matrix multiplication</h3>

<p>Matrix multiplication is simply a way to represent a sequence of
transformation. For example \(B.A\) , simply represents apply
transformation by A first and then B. This step by step transformation
will give same result at apply transformation by BA. For example lets
first flip the letter along y-axis and then apply skew left.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Flip 
</span><span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="c1">#skew left 
</span><span class="n">mat2</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">mat1</span><span class="p">)</span>  
<span class="n">VecTrans2</span><span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">,</span> <span class="n">mat2</span><span class="p">)</span>

<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans2</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-14-25.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-14-25.svg" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Flip 
</span><span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="c1">#skew left 
</span><span class="n">mat2</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">comb</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mat2</span><span class="p">,</span><span class="n">mat1</span><span class="p">)</span>

<span class="n">VecTrans</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">Centered</span><span class="p">,</span> <span class="n">comb</span><span class="p">)</span>  
<span class="n">DigitImage</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-15-27.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-15-27.svg" alt="" /></p>

<h3 id="inverse-matrix">Inverse matrix</h3>

<p>This is the matrix which will revert the transformation caused by its
complementary matrix.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#inverse of comb matrix above is 
</span><span class="n">invMat</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">inv</span><span class="p">(</span><span class="n">comb</span><span class="p">)</span>
<span class="c1">#apply this inv transformation to VecTrans
</span><span class="n">Orig</span> <span class="o">=</span> <span class="n">matrixTrans</span><span class="p">(</span><span class="n">VecTrans</span><span class="p">,</span> <span class="n">invMat</span><span class="p">)</span>  
<span class="n">DigitImage</span><span class="p">(</span><span class="n">Orig</span><span class="p">)</span>
</code></pre></div></div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-16-29.svg" data-src="/assets/img/posts/Essence-of-Linear-Algebra-with-Python_files/figure-markdown/unnamed-chunk-16-29.svg" alt="" /></p>
<hr>
<div class="share-holder">
  <span class="share-label">Share on: </span>
  <ul class="share-buttons">
    
      <li>
        <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2022-02-10-Matrix&amp;text=Essence%20of%20Matrix%20operations%20with%20Python%20-%20Data%20churn%20by%20AK" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="Twitter" class="hover-effect-big">
          <i class="fa fa-twitter-square fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2022-02-10-Matrix" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="Facebook" class="hover-effect-big">
          <i class="fa fa-facebook-square fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2022-02-10-Matrix&amp;text=Essence%20of%20Matrix%20operations%20with%20Python%20-%20Data%20churn%20by%20AK" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="Telegram" class="hover-effect-big">
          <i class="fa fa-telegram fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2022-02-10-Matrix" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="LinkedIn" class="hover-effect-big">
          <i class="fa fa-linkedin-square fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="mailto:?subject=Essence%20of%20Matrix%20operations%20with%20Python%20-%20Data%20churn%20by%20AK&amp;body=Essence%20of%20Matrix%20operations%20with%20Python%20-%20Data%20churn%20by%20AK%20http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2022-02-10-Matrix" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="Email" class="hover-effect-big">
          <i class="fa fa-envelope fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="javascript:void(0);" onclick="copyToClipboard('http://localhost:4000/posts/2022-02-10-Matrix', 'Link copied!')" id="copytoclipboard" data-toggle="tooltip" data-placement="top" title="Copy link" class="hover-effect-big">
          <i class="fa fa-link fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
  </ul>
</div>
</div>
</div>

    <div class="pagination_wrapper">
  <nav aria-label="Page navigation">
    <ul class="pagination" style="opacity:0">
    <li><a href="javascript:void(0);">1</a></li></ul>
  </nav>
</div>

  <div id="disqus_thread"></div>

<noscript>
  Please enable JavaScript to view the Comments.
</noscript>


</div><div class="footer-wrapper">
  <div class="footer-container">
    <footer translate="no">
      <div class="footer-text footer-text-centered long-copyright">
          <p>&copy; 2022 Data churn by AK. </p><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" data-tooltip-no-hide title="Except where otherwise noted, content on this web site is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.">
              <img src="/assets/img/default/cc/cc.svg" alt="cc" width="12" height="12">&nbsp;<img src="/assets/img/default/cc/by.svg" alt="by" width="12" height="12">&nbsp;<img src="/assets/img/default/cc/sa.svg" alt="sa" width="12" height="12">&nbsp;<p>Some rights reserved.</p>
            </a></div>
      <p class="footer-powered"><span>Pwrd by </span><a href="https://github.com/MrGreensWorkshop/MrGreen-JekyllTheme" target="_blank" rel="noopener noreferrer">Mr. Green</a></p>
    </footer>
  </div>
</div>
<div class="scroll-to-top-container">
        <a id="scroll-to-top" href="#main-wrapper" class="hover-effect"><i class="fa fa-angle-up"></i></a>
      </div></div>

    <div class="searchbox-container">
  <form id="searchbox-form" >
    <input type="search" id="search-box" placeholder="Search"
    onkeyup="if(this.value!==''){document.getElementById('search-results').style.display = 'block';}"
    onfocusout="this.value='';"
    onblur="setTimeout(function(){ document.getElementById('search-results').style.display = 'none'; }, 100);">
    <ul id="search-results" ></ul>
  </form>
</div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v0.4.1/dist/bootstrap-toc.min.js"></script>

<script src="/assets/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script>
      $('.imgViewer[data-no-image-viewer]').css("cursor", "unset");
      $(function () {
        $('.imgViewer:not([data-no-image-viewer])').magnificPopup({
          type: 'image'
          ,image: {
            titleSrc: 'alt'
            /* Error message */
            ,tError: 'The image could not be loaded.<br><br>%url%'
            /* Set to null to disable zoom out cursor. */
            /*,cursor: null */
          }
          ,closeOnContentClick: true
          ,showCloseBtn: false
          ,zoom: {
            /* By default it's false, so don't forget to enable it */
            enabled: true
            /* duration of the effect, in milliseconds */
            ,duration: 300
            /* CSS transition easing function */
            ,easing: 'ease-in-out'
          }
        });
      });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js"></script>
    <script>
      /* lazy loads elements with default selector as '.lozad' */
      const observer = lozad();
      observer.observe();
    </script>

<script>
      PagerPageNumbers.setProperties({
        paginatorListContainerName: ".pagination_wrapper .pagination"
        ,pageList: ["/posts/2022-03-03-Simple-linear-regression", "/posts/2022-02-05-Python-Data-Structures", "/posts/2022-02-03-Objects-in-R", "/posts/2022-02-10-Matrix", "/posts/2022-01-13-Principle-of-inference", "/posts/2021-06-14-OneWay-ANOVA", "/posts/2020-02-07-ChiSquare-Distribution", "/posts/2019-11-01-Expected-value", "/posts/2019-07-01-Degree-of-freedom", "/posts/2018-12-02-Mean-N-Variance", "/posts/2018-06-22-Permutation-n-Combination"]
        ,firstButtonName: 'First'
        ,lastButtonName: 'Last'
        ,prevButtonName: ""
        ,nextButtonName: ""
      });
    </script>



<script src="/assets/js/simple-jekyll-search-1.9.2.min.js"></script><script>
  function loadSearch(jsonData, searchParam) {
    if (!jsonData) jsonData = '/query/search.json';
    var searchInput = document.getElementById('search-box');

    const simpleJekyllSearch = SimpleJekyllSearch({
      searchInput: searchInput
      ,resultsContainer: document.getElementById('search-results')
      ,json: jsonData
      ,searchResultTemplate: '<li><a href="{url}">{title}<span>{date}</span></a></li>'
      ,noResultsText: '<li>No results found.</li>'
      ,limit: 10
      ,fuzzy: false
    });

    if (searchParam) {
      searchInput.value = searchParam;
      searchInput.focus();
      searchInput.disabled=false;
      setTimeout(function(){
        simpleJekyllSearch.search(searchParam);
      }, 400);
    }
  }

  </script>

<script>
    function isEmpty(value) {
      if (value === "" || value === null || typeof value === "undefined") return true;
      return false;
    }

    function getQueryParam (param, mach = true) {
      var queryString = window.location.search.substring(1);
      if (isEmpty(queryString)) return null;
      var queries = queryString.split("&");
      for (var i in queries) {
        var pair = decodeURIComponent(queries[i]).split("=");
        if (mach == true){
          if (pair[0] == param) {
            if (isEmpty(pair[1]) === false) return pair[1];
          }
        }else{
          return pair;
        }
        break;
      }
      return null;
    }

    const searchParam = getQueryParam('search');

    (async () => {
      let resp = await fetch('/query/search.json');
      if (!resp.ok) return;
      let jsonData = await resp.json();
      loadSearch(jsonData, searchParam);
    })();
  </script>
<script>
  const disqus_consent_msg = true;
  var disqus_config = function () {
    this.language = "en";
    this.page.url = 'http://localhost:4000/posts/2022-02-10-Matrix';
    this.page.identifier = '/posts/2022-02-10-Matrix';
  };

  function disqusLoader() {
    var d = document, s = d.createElement('script');
    s.src = 'https://https-datachurnbyak-github-io.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }

  /* reload when data-color-scheme changes. (dark, light) */
  function disqusReloader() {
    if (typeof DISQUS === "undefined") return;
    DISQUS.reset({
      reload: true
      ,config: disqus_config
    });
  }
  const color_scheme_observer = new MutationObserver(disqusReloader);
  color_scheme_observer.observe(document.body, {attributeFilter: ["data-color-scheme"]});
  /* comments load mode */
  let discusLoadDoNotAskStorageKey = "disqusLoadDoNotAskAgain";

  function add_click_to_load_button() {
    if (localStorage.getItem(discusLoadDoNotAskStorageKey)) disqusLoader();

    /* create element */
    let newElement = document.createElement("div");

    if (disqus_consent_msg == true) {
      newElement.innerHTML = "<div class=\"multipurpose-container\" style=\"margin:20px\"> <h4 style=\"margin-top: 0;\">Comments (Disqus.com)</h4> <p> Comment feature is hosted by a third party. By showing the external content you accept the <a href=\"https://help.disqus.com/en/articles/1717102-terms-of-service\" target=\"_blank\" rel=\"noopener noreferrer\">Terms of Service</a> and <a href=\"https://help.disqus.com/en/articles/1717103-disqus-privacy-policy\" target=\"_blank\" rel=\"noopener noreferrer\">Privacy Policy</a> of disqus.com. <br>If you prefer to opt out of targeted advertising, open <a href=\"https://disqus.com/data-sharing-settings\" target=\"_blank\" rel=\"noopener noreferrer\">this link</a> and click \"opt-out\" button and close. Return here and load comments. </p> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority load_comments\" data-comment-always-load role=\"button\">Always show</a> &nbsp;<a href=\"javascript:void(0);\" class=\"btn-base load_comments\" role=\"button\">Show only this time</a> </div>";
    } else {
      newElement.innerHTML = '<a href="javascript:void(0);" class="btn-base load_comments" role="button">Load Comments</a>';
      newElement.style.textAlign = 'center';
      newElement.style.minHeight = '20px';
    }

    /* add button */
    let holder = document.querySelector('#disqus_thread');
    if (!holder) return;
    holder.appendChild(newElement);
    /* add button click event */
    let buttons = document.querySelectorAll('#disqus_thread .load_comments');
    if (!buttons) return;
    buttons.forEach(function (button) {
      button.addEventListener('click', buttonCallback);
    });

    function buttonCallback(e) {
      disqusLoader();
      /* scroll to page bottom to see comments. */
      document.getElementById('disqus_thread').style.height = '394px';
      window.scrollTo(0, document.body.scrollHeight);
      if (e.target.hasAttribute('data-comment-always-load')) {
        localStorage.setItem(discusLoadDoNotAskStorageKey, true);
      }
    };
  }
  /* load when slide to the end of page */
  window.addEventListener("load", add_click_to_load_button);
  </script>


    <script id="dsq-count-scr" src="https://https-datachurnbyak-github-io.disqus.com/count.js" async></script>
    <script>
        if (window.location.hash == "#disqus_thread") {
          let element = document.getElementById('disqus_thread');
          $("html, body").animate({ scrollTop: $(element).offset().top }, 600);
        }
      </script>
     


<script>
  CookieConsent.consentSettingHtml = "<h5>Cookie settings</h5> <br> <p class=\"info-text\">This website uses cookies to optimize site functionality. It will be activated with your approval. Please click each item below for cookie policy. Check <a href=\"/privacy-policy.html\">Privacy policy</a> </p> <table> <tr> <td onclick=\"$('.info[data-consent-info=necessary]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Strictly necessary cookies</p> </td> <td> <span class=\"active_text\">Always active</span></td> </tr> </table> <div class=\"info\" data-consent-info=\"necessary\"> <p>These cookies are essential for the website function and cannot be disable. They are usually set when site function like color scheme etc. is changed. These cookies do not store any personally identifiable information. Enables storage related to security such as authentication functionality, fraud prevention, and other user protection. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=analytics]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Performance cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" checked=\"checked\" data-consent=\"analytics\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"analytics\"> <p>Enables storage (such as cookies) related to analytics e.g. visit duration. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=preferences]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Functionality cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"preferences\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"preferences\"> <p>Enables storage that supports the functionality of the website or app e.g. language settings. Enables storage related to personalization e.g. video recommendations. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=advertising]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Targeting and advertising cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"advertising\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"advertising\"> <p>Enables storage (such as cookies) related to advertising. </p> </div> <br> <div class=\"button-holder\"> <a href=\"javascript:void(0);\" class=\"btn-base btn-left\" onclick=\"CookieConsent.consentSettingDone('deny');\" role=\"button\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentSettingDone('accept');\" role=\"button\">Allow all</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentSettingDone('save');\" role=\"button\">Allow selection</a> </div>";
  CookieConsent.consentBarHtml = "<div class=\"consent-bar\"> <a class=\"close-button\" href=\"javascript:void(0);\" onclick=\"CookieConsent.hideConsentBar();\"><i class=\"fa-fw fa fa-times\"></i></a> <p>This website uses cookies to optimize site functionality. It will be activated with your approval. Check <a href=\"/privacy-policy.html\">Privacy policy</a> </p> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('deny');\" role=\"button\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('settings');\" role=\"button\">Customize</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentBarDone('accept');\" role=\"button\">Allow all</a> </div>";
  CookieConsent.consent_items = JSON.parse('{"necessary":{"group":["security_storage"],"value":"granted","wait_for_update":500,"cookie_domain":"","no_check_box":true},"analytics":{"group":["analytics_storage"],"value":"denied"},"preferences":{"group":["functionality_storage","personalization_storage"],"value":"denied"},"advertising":{"group":["ad_storage"],"value":"denied"}}');
  CookieConsent.hideConsentBarWithSaveButton = true;

  const consent_settings = CookieConsent.getConsentSettings();
  const default_configs = JSON.parse('{"anonymize_ip":true,"ads_data_redaction":true,"cookie_flags":"SameSite=None;Secure"}');
</script>
</body>
</html>

