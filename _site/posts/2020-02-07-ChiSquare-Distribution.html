<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Data churn by AK - Chi squared distribution</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" media="print" onload="this.media='all'">
<noscript>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
</noscript>



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="manifest" href="/assets/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#f0f0f0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Data churn by AK's App">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="msapplication-TileColor" content="#2d89ef">
  <meta name="msapplication-starturl" content="/">
  <meta name="application-name" content="Data churn by AK's App">
  <meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">

    <meta name="keywords" content="Statistics, degree of freedom, expected value, sample variance, Chi squared">

  <meta name="description" content="chi squared distribution explained in plain english intuitive way ">
  <meta name="robots" content="index, follow">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chi squared distribution">
<meta name="twitter:site" content="@amritkoirala1">
<meta name="twitter:description" content="chi squared distribution explained in plain english intuitive way ">
<meta name="twitter:image" content="http://localhost:4000/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-3-1.svg">
<meta property="og:site_name" content="Data churn by AK">
<meta property="og:type" content="article">
<meta property="og:title" content="Chi squared distribution">
<meta property="og:description" content="chi squared distribution explained in plain english intuitive way ">
<meta property="og:url" content="http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution">
<meta property="og:image" content="http://localhost:4000/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-3-1.svg">
  <meta property="article:author" content="Amrit Koirala">
  <meta property="article:published_time" content="2020-02-06T17:11:06-06:00">
  <meta property="article:modified_time" content="2020-02-06T17:11:06-06:00">
  <meta property="article:section" content="Statistics">
  <meta property="article:tag" content="degree of freedom">
  <meta property="article:tag" content="expected value">
  <meta property="article:tag" content="sample variance">
  <meta property="article:tag" content="Chi squared">
  <script type="application/ld+json">{
  "@context": "https://schema.org"
  ,"@graph": [
    {
      "@type": "Person"
      ,"@id": "http://localhost:4000/#person"
      ,"name": "Amrit Koirala"
      ,"url": "http://localhost:4000/tabs/about.html"
      ,"image": "http://localhost:4000/assets/img/about/about.jpg"
      ,"description": "Data churn by AK is Amrit Koirala's journey in bioinformatics and data science."
  },{
    "@type": "WebSite"
    ,"@id": "http://localhost:4000/#website"
    ,"url": "http://localhost:4000/"
    ,"name": "Data churn by AK"
    ,"description": "Data churn by AK is Amrit Koirala's journey in bioinformatics and data science."
    ,"publisher": {"@id": "http://localhost:4000/#person"}
    ,"inLanguage": "en-US"
    ,"sameAs": ["https://www.github.com/akoirala2000","https://www.linkedin.com/in/amrit-koirala-41037392","https://www.twitter.com/amritkoirala1"]
    ,"copyrightHolder" : {"@id": "http://localhost:4000/#person"}
    ,"copyrightYear" : "2022"
  },{
    "@type": "WebPage"
    ,"@id": "http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution#webpage"
    ,"url": "http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution"
    ,"name": "Chi squared distribution"
    ,"isPartOf": {"@id": "http://localhost:4000/#website"}
    ,"breadcrumb": {"@id": "http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution#breadcrumb"}
    ,"primaryImageOfPage": "http://localhost:4000/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-3-1.svg"
    ,"datePublished": "2020-02-06T17:11:06-06:00"
    ,"dateModified": "2020-02-06T17:11:06-06:00"
    ,"description": "chi squared distribution explained in plain english intuitive way "
    ,"inLanguage": "en-US"
    ,"potentialAction": {
      "@type": "ReadAction"
      ,"target": "http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution"
    }
  },{
      "@type": "BreadcrumbList",
      "@id": "http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem"
          ,"position": 1
          ,"name": "Home"
          ,"item": "http://localhost:4000/"
        },
        {
          "@type": "ListItem"
          ,"position": 2
          ,"name": "Notes"
          ,"item": "http://localhost:4000/tabs/blog/"
        },
        {
          "@type": "ListItem"
          ,"position": 3
          ,"name": "Chi squared distribution"
        }
      ]
    },{
      "@type": "BlogPosting"
      ,"@id": "http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution#content"
      ,"isPartOf": {"@id": "http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution#webpage"}
      ,"mainEntityOfPage": {"@id": "http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution#webpage"}
      ,"publisher": {"@id": "http://localhost:4000/#person"}
      ,"author": {"@id": "http://localhost:4000/#person"}
      ,"inLanguage": "en-US"
      ,"headline": "Chi squared distribution"
      ,"image": "http://localhost:4000/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-3-1.svg"
      ,"thumbnailUrl": "http://localhost:4000/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-3-1.svg"
      ,"datePublished": "2020-02-06T17:11:06-06:00"
      ,"dateModified": "2020-02-06T17:11:06-06:00"
      ,"articleSection": ["Statistics", "degree of freedom", "expected value", "sample variance", "Chi squared"]
      ,"description": "chi squared distribution explained in plain english intuitive way "
      ,"copyrightHolder" : {"@id": "http://localhost:4000/#person"}
      ,"copyrightYear" : "2022"
      ,"wordCount": 1255
      ,"articleBody": "Distribution of sample variance Just like sampling distribution of sample mean, sample variance follows a distribution but it is slightly complex than, normal distribution followed sample mean. The shape of this distribution varies according the sample size. Therefore, there is a different curve to represent distribution of sample variance from samples of different sizes. Since, mean of distribution of sample variance (expected value) is equal to population variance, sample variance is also called unbiased estimate of population variance. The Mean and variance of such distribution is given by following formulas (keep reading for proof). \\[mean(s^2) = \\sigma^2\\] and variance of \\[Var(s^2)= \\frac{2(\\sigma^2)^2}{v}\\] Where, \\(v\\) is degree of freedom given by n-1. To get some intuition, lets make some simulated distribution of sample variance from a population with mean 70 and variance 100 taking samples of size(n) = {3,5,9,15,50,100}, re-sampled 1000 times, Figure 1 shows the histogram of sample variance of those 1000 samples for each size. code here par(mfrow=c(3,2)) set.seed(56) #make a dummy population with N= 1000, \\mu = 70 and \\sigma= 10 pop&lt;- rnorm(1000, mean= 70, 10) sample_size = c(3,5,9,15,50,100) for (size in 1:length(sample_size)) { sample_variance &lt;- NULL for (i in 1:1000) { sample &lt;- sample(pop, sample_size[size]) sample_variance&lt;-c (sample_variance, var(sample)) } hist(sample_variance,breaks = 200, main=paste0('Dist of sample variance n = ', sample_size[size],' \\n mean of var = ' ,round(mean(sample_variance),1), \" variance of var = \", round(var(sample_variance),1)), xlim=c(0,400), ylim = c(0,60)) } done! As you can see from the figure above the shape of histogram is different for each sample size and mean and variance of these distribution are also very close to the one that could be calculated by above formulas. When the sample size is small (n=3), it is positively skewed with long tail on right and most of the mass of distribution at zero. What this suggesting is when we use only 3 observations, most of the time we get very small variance. But how does it compare to the population variance? With such small sample size although mean of the whole distribution is still equal to the population variance, there is high probability that a randomly selected sample variance will underestimate the true variance. As we increase the sample size to 5, the mass of distribution moves slightly right and is slightly less skewed than n=3. As we keep increasing our sample size to 100, the distribution looks much like normal distribution with both mean and median equal to population variance and there is much less variance in sample variance compared to our smallest sample size (n=3). This signifies that if we have big enough sample size, a randomly selected sample is much likely to represent the population variance. \\(\\chi^2\\) distribution We know variance is mean of sum of square of deviations. If we look at only the deviations, it is, a random variable that follows a normal distribution (because both \\(X\\) and \\(\\bar X\\) follows normal distribution). Since, all other terms in variance are constant, we can find the distribution of sample variance if we know the distribution of sum of square of deviations. And this is exactly what \\(\\chi^2\\) gives. To simplify the calculations it is always calculated from the standard normal distribution and is applicable for any random variable that follows standard normal distribution. Suppose \\(Z\\) is a random variable following standard normal distribution \\(Z \\sim N(0,1)\\). Then the distribution given by the sum of square of n items from this distribution follows \\(\\chi ^2\\) distribution which is defined by single parameter, the number of independent items used in the calculation of sum of \\(Z^2\\) (\\(v\\)). \\[\\chi^2= \\sum Z^2\\] \\(\\chi^2\\) distribution has following properties: Being the sum of squares, it can never be less than zero. The shape of distribution changes with the number of z used to calculation the sum. The mean of the distribution is given by \\(v\\) and variance given by \\(2v\\). When the sample size is larger (&gt;30), the \\(\\chi^2\\) distribution is very similar to normal distribution. It is so similar that a normal distribution with mean \\(z=\\frac{X-v}{\\sqrt(2v)}\\) can be used calculate z and used std normal distribution. To build the intuition, lets see it in R, first by making a standard normal distribution and then sampling \\(z\\) of different sample size and then calculating the sum of square of \\(z\\)s in that sample. Histograms shows \\(\\chi^2\\) distribution at degree of freedom equal to {3,5,9,15,100}. See if our histograms comply with the properties of \\(\\chi^2\\) distribution. code here par(mfrow=c(3,2)) set.seed(56) stdNormal &lt;- rnorm(1000) sample_size = c(3,5,9,15,50,100) for (size in 1:length(sample_size)) { sumXsq &lt;- NULL for (i in 1:1000) { X &lt;- sample(stdNormal, sample_size[size]) sumXsq&lt;-c (sumXsq, sum(X^2)) } hist(sumXsq,breaks = 200, main=paste0('Dist of Sum of X squared n = ', sample_size[size],' \\n mean = ' ,round(mean(sumXsq),1), \" variance = \", round(var(sumXsq),1)), xlim=c(0,150), ylim = c(0,30)) } done! Also visualize how these distributions will actually look when produced from the mathematical formula for \\(\\chi^2\\) distribution. code here curve(dnorm(x), from = -3,to= 20, col= \"darkgreen\", ylab= \"density\", xlab=\"Chi Squared\") linecol &lt;- rainbow(6) size = c(3,5,9,15,50,100) for(i in 1:length(size)){ curve(dchisq(x, df=size[i]-1), from = 0,to= 20, col= linecol[i], add = T) } legend(13,0.4, legend = c(\"Std Normal\", paste0(\"df = \", size )), col= c(\"darkgreen\",linecol), lty= c(1,1,1,1,1,1,1)) done! \\(\\chi^2\\) statistic Now the we understand the \\(\\chi^2\\) distribution, lets see how can we establish relationship between sample variance and this distribution. From the equation for \\(\\chi^2\\) we know : \\[\\chi^2= \\sum Z^2\\] \\[= \\sum\\left(\\frac{Y-\\bar Y}{\\sigma}\\right)^2\\] \\(= \\frac{\\sum(Y- \\bar Y)^2}{\\sigma^2}\\) We know the equation for sample variance is \\(s^2= \\frac{\\sum(Y- \\bar Y)^2}{n-1}\\), Substituting the value of sum of squares (SS); \\[\\chi^2= \\frac{(n-1)s^2}{\\sigma^2}\\] One we have this \\(\\chi^2\\) statistics we can get the idea about the probability of variance of particular sample from \\(\\chi^2\\) distribution which follows n-1 degree of freedom. Check my notes on degree of freedom if you are not sure why we need to use n-1 degree of freedom. Lets also see how \\(\\chi^2\\) statistics would distribute in our simulate data. code here par(mfrow=c(3,2)) set.seed(56) #make a dummy population with N= 1000, \\mu = 70 and \\sigma= 10 pop&lt;- rnorm(1000, mean= 70, 10) sample_size = c(3,5,9,15,50,100) for (size in 1:length(sample_size)) { sample_variance &lt;- NULL for (i in 1:1000) { sample &lt;- sample(pop, sample_size[size]) sample_variance&lt;-c (sample_variance, var(sample)) chisq &lt;- (length(sample)-1)*sample_variance/100 } hist(chisq,breaks = 200, main=paste0('Dist of chisq n = ', sample_size[size],' \\n mean of chisq = ' ,round(mean(chisq),1), \" variance of chisq = \", round(var(chisq),1)), xlim=c(0,150), ylim = c(0,30)) } done! Derivation of mean of sampling distribution of variance This distribution is exactly same as we got from standard normal distribution in figure above. We can also use this equation and the properties of \\(\\chi^2\\) to derive the mean and variance of distribution of sample variance. From the equation for \\(\\chi^2\\) \\(\\chi^2= \\frac{vs^2}{\\sigma^2}\\) \\(\\text{or, } s^2 = \\frac{\\chi^2 \\sigma^2}{v}\\) From the property of \\(\\chi^2\\) distribution, the value of \\(\\chi^2\\) at mean of the distribution is \\(v\\). \\[mean(s^2)=\\frac{v\\sigma^2}{v}\\] \\[mean(s^2)= \\sigma^2\\] This again, shows expected value of sampling distribution of sample variance is equal to population variance. Variance of sampling distribution of variance To prove this we can start from the fact that we know variance of \\(\\chi^2\\) distribution is \\(2v\\) \\[Var(\\chi^2) = 2v\\] \\[Var\\left(\\frac{vs^2}{\\sigma^2}\\right)=2v\\] \\[\\frac{v^2}{\\sigma^4}Var(s^2)= 2v\\] \\[Var(s^2)=\\frac{2\\sigma^4}{v}\\] Conclusion Although we do not use \\(\\chi^2\\) most often directly in hypothesis testing, but this distribution is the one which establish a connecting link between population variance (\\(\\sigma^2\\)) and sample variance (\\(s^2\\)). Therefore any hypothesis testing where population variance is estimated based on the sample variance this distribution is being used under the hood which we will see more clearly in the t-distribution and F-distribution."
    }
  ]
}</script>


<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<link href="/assets/css/main.css" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v0.4.1/dist/bootstrap-toc.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.css">
<link href="/assets/css/nav-media.css" rel="stylesheet">

  </head>

  <body >
    <script src="/assets/js/color-scheme-attr-init.js" data-mode="false"></script>
    <nav class="navbar navbar-default top-nav">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed pull-left top-nav-menu-toggle" data-toggle="collapse" data-target="#id_top-nav-menu-toggle" aria-expanded="false">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand top-nav-brand" href="/" translate="no">Data churn by AK</a>
    </div>
  <div class="color_scheme_switch_top_holder" data-toggle="tooltip" data-placement="bottom" title="Color scheme">
  <label class="color-scheme-switch hover-effect">
    <input type="checkbox" class="checkbox_color_switch" />
    <span></span>
  </label>
</div>

  
</nav>
<nav id="side-nav-container">
  <div class="side-nav">
    <div class="side-nav-brand">
      <img src="/assets/img/default/profile.jpg" alt="">
      <div class="brand-holder">
        <a href="/" translate="no">Data churn by AK</a>
        </div>
      <p>&nbsp;Data blogs</p>
      <br>
    </div>
    <br>
    <a href="javascript:void(0);" class="side-nav-close">
        <i class="fa fa-angle-double-left fa-2x" aria-hidden="true"></i>
      </a>
    <hr>
    <br>
    <div class="side-nav-buttons">
      <ul class="nav nav-pills nav-stacked">
        <li ><a href="/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/tabs/blog/" class="active-page hover-effect"><i class="fa-fw fa fa-pencil-square-o" aria-hidden="true"></i>Notes</a></li><li ><a href="/tabs/archive.html" class=" hover-effect"><i class="fa-fw fa fa-archive" aria-hidden="true"></i>Archive</a></li><li ><a href="/tabs/projects.html" class=" hover-effect"><i class="fa-fw fa fa-book" aria-hidden="true"></i>Notebooks</a></li><li ><a href="/tabs/links.html" class=" hover-effect"><i class="fa-fw fa fa-link" aria-hidden="true"></i>Links</a></li><li ><a href="/tabs/about.html" class=" hover-effect"><i class="fa-fw fa fa-user-o" aria-hidden="true"></i>About</a></li></ul>
    </div>
    <br>
    <br><div class="contact-container">
  <hr>
  <h3>Contact</h3>
  <ul><li><a href="https://www.github.com/akoirala2000" class="hover-effect-big" target="_blank" rel="noopener noreferrer"><i class="fa fa-github" aria-hidden="true"></i></a></li><li>
      <a href="javascript:void(0);" class="hover-effect-big" onclick="setAddress('datachurnbyak', 'gmail.com');"><i class="fa fa-envelope-o" aria-hidden="true"></i></a></li><li><a href="https://www.linkedin.com/in/amrit-koirala-41037392" class="hover-effect-big" target="_blank" rel="noopener noreferrer"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a href="https://www.twitter.com/amritkoirala1" class="hover-effect-big" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter" aria-hidden="true"></i></a></li></ul>
</div>

    <hr id="toc-view-top">
    <div class="side-nav-footer" translate="no">
        <p>&copy; 2022 Data churn by AK.</p>
      </div>
  </div>
  <div class="side-nav-bottom-buttons-container">
    <hr>
    <ul>
      <li><div class="color_scheme_switch_side_holder" data-toggle="tooltip" data-placement="top" title="Color scheme">
  <label class="color-scheme-switch hover-effect">
    <input type="checkbox" class="checkbox_color_switch" />
    <span></span>
  </label>
</div>
</li><li><div class="cookie-icon hover-effect" onclick="CookieConsent.showSettings();" data-toggle="tooltip" data-placement="top" title="Cookie settings">
  <div class="cookie-wrapper">
    <i class="fa fa-circle bitten-cookie" aria-hidden="true"></i>
    <i class="fa fa-circle small-ellipse-icon" aria-hidden="true"></i>
    <i class="fa fa-spinner inner-icon" aria-hidden="true"></i>
    <i class="fa fa-circle-thin outer-icon" aria-hidden="true"></i>
  </div>
</div>
</li></ul>
  </div></nav>
<div id="toc-container" class="movable">
  <div class="panel panel-default">
    <div class="panel-heading" data-toggle="tooltip" data-placement="top" title="Drag to move">
      Contents
      <span class="pull-right">
        <a href="javascript:void(0);" class="close-button" onclick="document.getElementById('toc-container').style.display = 'none';">
          <i class="fa fa-times" data-toggle="tooltip" data-placement="bottom" title="Close"></i>
        </a>
      </span>
    </div>
    <div class="panel-body">
      <nav id="table-of-contents"></nav>
    </div>
  </div>
</div>
<div id="main-wrapper">
      <div class="main-container"><div class="multipurpose-container post-container">
  <div class="post-title">Chi squared distribution</div><div class="meta">
  <small>
    &nbsp;<i class="fa fa-calendar"></i>&nbsp;&nbsp;Feb 6, 2020
  </small>
  <small>
    &nbsp;&nbsp;&nbsp;<span><i class="fa fa-clock-o"></i>&nbsp;9 min read</span>
  </small>
  
  <small class="meta-link" >
    &nbsp;&nbsp;&nbsp;<i class="fa fa-comments-o"></i>&nbsp;<a href="/posts/2020-02-07-ChiSquare-Distribution#disqus_thread">-</a>
    <a href="javascript:void(0);" onclick="window.location.href='/posts/2020-02-07-ChiSquare-Distribution#disqus_thread'">Comments</a>
  </small>
  </div>
<hr/>
  <div class="markdown-style">
    <h3 id="distribution-of-sample-variance">Distribution of sample variance</h3>
<!-- outline-start -->
<p>Just like sampling distribution of sample mean, sample variance follows
a distribution but it is slightly complex than, normal distribution
followed sample mean. The shape of this distribution varies according
the sample size.<!-- outline-end --> Therefore, there is a different curve to represent
distribution of sample variance from samples of different sizes. Since,
mean of distribution of sample variance (<a href="">expected value</a>) is equal to
population variance, sample variance is also called unbiased estimate of
population variance. The Mean and variance of such distribution is given
by following formulas (keep reading for proof).</p>

\[mean(s^2) = \sigma^2\]

<p>and variance of</p>

\[Var(s^2)= \frac{2(\sigma^2)^2}{v}\]

<p>Where, \(v\) is <a href="/posts/2019-07-01-Degree-of-freedom">degree of freedom</a> given by n-1.</p>

<p>To get some intuition, lets make some simulated distribution of sample
variance from a population with mean 70 and variance 100 taking samples
of size(n) = {3,5,9,15,50,100}, re-sampled 1000 times, Figure 1 shows
the histogram of sample variance of those 1000 samples for each size.</p>

<div class="panel-group">
  <div class="panel panel-default" style="white-space: normal; overflow-x: auto; ">
        <button data-toggle="collapse" data-target="#toggle-code1">
           code here 
        </button>
    </div>
    <div id="toggle-code1" class="panel-collapse collapse">
      <div class="panel-body">
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">56</span><span class="p">)</span><span class="w">
</span><span class="c1">#make a dummy population with N= 1000, \mu = 70 and \sigma= 10</span><span class="w">
</span><span class="n">pop</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="w"> </span><span class="m">70</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
</span><span class="n">sample_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">sample_size</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">sample_variance</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w">
    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">sample</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">sample_size</span><span class="p">[</span><span class="n">size</span><span class="p">])</span><span class="w">
    </span><span class="n">sample_variance</span><span class="o">&lt;-</span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="n">sample_variance</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">hist</span><span class="p">(</span><span class="n">sample_variance</span><span class="p">,</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="n">paste0</span><span class="p">(</span><span class="s1">'Dist of sample variance n = '</span><span class="p">,</span><span class="w">
                               </span><span class="n">sample_size</span><span class="p">[</span><span class="n">size</span><span class="p">],</span><span class="s1">' \n mean of var = '</span><span class="w">
                               </span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">sample_variance</span><span class="p">),</span><span class="m">1</span><span class="p">),</span><span class="w"> 
                               </span><span class="s2">" variance of var = "</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">sample_variance</span><span class="p">),</span><span class="m">1</span><span class="p">)),</span><span class="w">
                                </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">400</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">60</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
</div>
      <div class="panel-footer">done!</div>
  </div>
</div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-1-1.svg" data-src="/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-1-1.svg" alt="Distribution of sample variance" /></p>

<p>As you can see from the figure above the shape of histogram is different
for each sample size and mean and variance of these distribution are
also very close to the one that could be calculated by above formulas.
When the sample size is small (n=3), it is positively skewed with long
tail on right and most of the mass of distribution at zero. What this
suggesting is when we use only 3 observations, most of the time we get
very small variance. But how does it compare to the population variance?
With such small sample size although mean of the whole distribution is
still equal to the population variance, there is high probability that a
randomly selected sample variance will underestimate the true variance.
As we increase the sample size to 5, the mass of distribution moves
slightly right and is slightly less skewed than n=3. As we keep
increasing our sample size to 100, the distribution looks much like
normal distribution with both mean and median equal to population
variance and there is much less variance in sample variance compared to
our smallest sample size (n=3). This signifies that if we have big
enough sample size, a randomly selected sample is much likely to
represent the population variance.</p>

<h3 id="chi2-distribution">\(\chi^2\) distribution</h3>

<p>We know variance is mean of sum of square of deviations. If we look at
only the deviations, it is, a random variable that follows a normal
distribution (because both \(X\) and \(\bar X\) follows normal
distribution). Since, all other terms in variance are constant, we can
find the distribution of sample variance if we know the distribution of
sum of square of deviations. And this is exactly what \(\chi^2\) gives.
To simplify the calculations it is always calculated from the standard
normal distribution and is applicable for any random variable that
follows standard normal distribution.</p>

<p>Suppose \(Z\) is a random variable following standard normal
distribution \(Z \sim N(0,1)\). Then the distribution given by the sum
of square of n items from this distribution follows \(\chi ^2\)
distribution which is defined by single parameter, the number of
independent items used in the calculation of sum of \(Z^2\) (\(v\)).</p>

\[\chi^2= \sum Z^2\]

<p>\(\chi^2\) distribution has following properties:</p>

<ol>
  <li>Being the sum of squares, it can never be less than zero.</li>
  <li>The shape of distribution changes with the number of z used to
calculation the sum.</li>
  <li>The mean of the distribution is given by \(v\) and variance given by
\(2v\).</li>
  <li>When the sample size is larger (&gt;30), the \(\chi^2\) distribution
is very similar to normal distribution. It is so similar that a
normal distribution with mean \(z=\frac{X-v}{\sqrt(2v)}\) can be
used calculate z and used std normal distribution.</li>
</ol>

<p>To build the intuition, lets see it in R, first by making a standard
normal distribution and then sampling \(z\) of different sample size and
then calculating the sum of square of \(z\)s in that sample. Histograms
shows \(\chi^2\) distribution at degree of freedom equal to
{3,5,9,15,100}. See if our histograms comply with the properties of
\(\chi^2\) distribution.</p>

<div class="panel-group">
  <div class="panel panel-default" style="white-space: normal; overflow-x: auto; ">
        <button data-toggle="collapse" data-target="#toggle-code2">
           code here 
        </button>
    </div>
    <div id="toggle-code2" class="panel-collapse collapse">
      <div class="panel-body">
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">56</span><span class="p">)</span><span class="w">
</span><span class="n">stdNormal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="n">sample_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">sample_size</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">sumXsq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w">
    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="n">stdNormal</span><span class="p">,</span><span class="w"> </span><span class="n">sample_size</span><span class="p">[</span><span class="n">size</span><span class="p">])</span><span class="w">
    </span><span class="n">sumXsq</span><span class="o">&lt;-</span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="n">sumXsq</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">X</span><span class="o">^</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">hist</span><span class="p">(</span><span class="n">sumXsq</span><span class="p">,</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="n">paste0</span><span class="p">(</span><span class="s1">'Dist of Sum of X squared n = '</span><span class="p">,</span><span class="w">
                               </span><span class="n">sample_size</span><span class="p">[</span><span class="n">size</span><span class="p">],</span><span class="s1">' \n mean = '</span><span class="w">
                               </span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">sumXsq</span><span class="p">),</span><span class="m">1</span><span class="p">),</span><span class="w"> 
                               </span><span class="s2">" variance = "</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">sumXsq</span><span class="p">),</span><span class="m">1</span><span class="p">)),</span><span class="w">
                                </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">150</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
</div>
      <div class="panel-footer">done!</div>
  </div>
</div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-2-1.svg" data-src="/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-2-1.svg" alt="" /></p>

<p>Also visualize how these distributions will actually look when produced
from the mathematical formula for \(\chi^2\) distribution.</p>

<div class="panel-group">
  <div class="panel panel-default" style="white-space: normal; overflow-x: auto; ">
        <button data-toggle="collapse" data-target="#toggle-code3">
           code here 
        </button>
    </div>
    <div id="toggle-code3" class="panel-collapse collapse">
      <div class="panel-body">
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">curve</span><span class="p">(</span><span class="n">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-3</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="w"> </span><span class="s2">"darkgreen"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="w"> </span><span class="s2">"density"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"Chi Squared"</span><span class="p">)</span><span class="w">
</span><span class="n">linecol</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rainbow</span><span class="p">(</span><span class="m">6</span><span class="p">)</span><span class="w">
</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">size</span><span class="p">)){</span><span class="w">
    </span><span class="n">curve</span><span class="p">(</span><span class="n">dchisq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="n">size</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="m">-1</span><span class="p">),</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="w"> </span><span class="n">linecol</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="m">13</span><span class="p">,</span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Std Normal"</span><span class="p">,</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="s2">"df = "</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="p">)),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"darkgreen"</span><span class="p">,</span><span class="n">linecol</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>
</div>
      <div class="panel-footer">done!</div>
  </div>
</div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-3-1.svg" data-src="/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-3-1.svg" alt="" /></p>

<h3 id="chi2-statistic">\(\chi^2\) statistic</h3>

<p>Now the we understand the \(\chi^2\) distribution, lets see how can we
establish relationship between sample variance and this distribution.
From the equation for \(\chi^2\) we know :</p>

\[\chi^2= \sum Z^2\]

\[= \sum\left(\frac{Y-\bar Y}{\sigma}\right)^2\]

<p>\(=  \frac{\sum(Y- \bar Y)^2}{\sigma^2}\) We know the equation for
sample variance is \(s^2= \frac{\sum(Y- \bar Y)^2}{n-1}\), Substituting
the value of sum of squares (SS);</p>

\[\chi^2=  \frac{(n-1)s^2}{\sigma^2}\]

<p>One we have this \(\chi^2\) statistics we can get the idea about the
probability of variance of particular sample from \(\chi^2\)
distribution which follows n-1 degree of freedom. Check my notes on
<a href="/posts/2019-07-01-Degree-of-freedom">degree of freedom</a> if you are not sure why we need to use n-1 degree
of freedom.</p>

<p>Lets also see how \(\chi^2\) statistics would distribute in our simulate
data.</p>

<div class="panel-group">
  <div class="panel panel-default" style="white-space: normal; overflow-x: auto; ">
        <button data-toggle="collapse" data-target="#toggle-code4">
           code here 
        </button>
    </div>
    <div id="toggle-code4" class="panel-collapse collapse">
      <div class="panel-body">
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">56</span><span class="p">)</span><span class="w">
</span><span class="c1">#make a dummy population with N= 1000, \mu = 70 and \sigma= 10</span><span class="w">
</span><span class="n">pop</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="o">=</span><span class="w"> </span><span class="m">70</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
</span><span class="n">sample_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">sample_size</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">sample_variance</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w">
    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">sample</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="w"> </span><span class="n">sample_size</span><span class="p">[</span><span class="n">size</span><span class="p">])</span><span class="w">
    </span><span class="n">sample_variance</span><span class="o">&lt;-</span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="n">sample_variance</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span><span class="w">
    </span><span class="n">chisq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="m">-1</span><span class="p">)</span><span class="o">*</span><span class="n">sample_variance</span><span class="o">/</span><span class="m">100</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">hist</span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="n">paste0</span><span class="p">(</span><span class="s1">'Dist of chisq n = '</span><span class="p">,</span><span class="w">
                               </span><span class="n">sample_size</span><span class="p">[</span><span class="n">size</span><span class="p">],</span><span class="s1">' \n mean of chisq = '</span><span class="w">
                               </span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">chisq</span><span class="p">),</span><span class="m">1</span><span class="p">),</span><span class="w"> 
                               </span><span class="s2">" variance of chisq = "</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">chisq</span><span class="p">),</span><span class="m">1</span><span class="p">)),</span><span class="w">
                                </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">150</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
</div>
      <div class="panel-footer">done!</div>
  </div>
</div>

<p><img class="lozad imgViewer mfp-zoom" data-mfp-src="/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-4-1.svg" data-src="/assets/img/posts/chisquared-distribution_files/figure-markdown/unnamed-chunk-4-1.svg" alt="" /></p>

<h4 id="derivation-of-mean-of-sampling-distribution-of-variance">Derivation of mean of sampling distribution of variance</h4>

<p>This distribution is exactly same as we got from standard normal
distribution in figure above. We can also use this equation and the
properties of \(\chi^2\) to derive the mean and variance of distribution
of sample variance.</p>

<p>From the equation for \(\chi^2\)</p>

<p>\(\chi^2=  \frac{vs^2}{\sigma^2}\)
\(\text{or,         } s^2 = \frac{\chi^2 \sigma^2}{v}\)</p>

<p>From the property of \(\chi^2\) distribution, the value of \(\chi^2\) at
mean of the distribution is \(v\).</p>

\[mean(s^2)=\frac{v\sigma^2}{v}\]

\[mean(s^2)= \sigma^2\]

<p>This again, shows expected value of sampling distribution of sample
variance is equal to population variance.</p>

<h4 id="variance-of-sampling-distribution-of-variance">Variance of sampling distribution of variance</h4>

<p>To prove this we can start from the fact that we know variance of
\(\chi^2\) distribution is \(2v\)</p>

\[Var(\chi^2) = 2v\]

\[Var\left(\frac{vs^2}{\sigma^2}\right)=2v\]

\[\frac{v^2}{\sigma^4}Var(s^2)= 2v\]

\[Var(s^2)=\frac{2\sigma^4}{v}\]

<h3 id="conclusion">Conclusion</h3>

<p>Although we do not use \(\chi^2\) most often directly in hypothesis
testing, but this distribution is the one which establish a connecting
link between population variance (\(\sigma^2\)) and sample variance
(\(s^2\)). Therefore any hypothesis testing where population variance is
estimated based on the sample variance this distribution is being used
under the hood which we will see more clearly in the t-distribution and
F-distribution.</p>
<hr>
<div class="share-holder">
  <span class="share-label">Share on: </span>
  <ul class="share-buttons">
    
      <li>
        <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2020-02-07-ChiSquare-Distribution&amp;text=Chi%20squared%20distribution%20-%20Data%20churn%20by%20AK" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="Twitter" class="hover-effect-big">
          <i class="fa fa-twitter-square fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2020-02-07-ChiSquare-Distribution" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="Facebook" class="hover-effect-big">
          <i class="fa fa-facebook-square fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2020-02-07-ChiSquare-Distribution&amp;text=Chi%20squared%20distribution%20-%20Data%20churn%20by%20AK" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="Telegram" class="hover-effect-big">
          <i class="fa fa-telegram fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2020-02-07-ChiSquare-Distribution" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="LinkedIn" class="hover-effect-big">
          <i class="fa fa-linkedin-square fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="mailto:?subject=Chi%20squared%20distribution%20-%20Data%20churn%20by%20AK&amp;body=Chi%20squared%20distribution%20-%20Data%20churn%20by%20AK%20http%3A%2F%2Flocalhost%3A4000%2Fposts%2F2020-02-07-ChiSquare-Distribution" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" title="Email" class="hover-effect-big">
          <i class="fa fa-envelope fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
      <li>
        <a href="javascript:void(0);" onclick="copyToClipboard('http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution', 'Link copied!')" id="copytoclipboard" data-toggle="tooltip" data-placement="top" title="Copy link" class="hover-effect-big">
          <i class="fa fa-link fa-fw" aria-hidden="true"></i>
        </a>
      </li>
    
  </ul>
</div>
</div>
</div>

    <div class="pagination_wrapper">
  <nav aria-label="Page navigation">
    <ul class="pagination" style="opacity:0">
    <li><a href="javascript:void(0);">1</a></li></ul>
  </nav>
</div>

  <div id="disqus_thread"></div>

<noscript>
  Please enable JavaScript to view the Comments.
</noscript>


</div><div class="footer-wrapper">
  <div class="footer-container">
    <footer translate="no">
      <div class="footer-text footer-text-centered long-copyright">
          <p>&copy; 2022 Data churn by AK. </p><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" data-tooltip-no-hide title="Except where otherwise noted, content on this web site is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.">
              <img src="/assets/img/default/cc/cc.svg" alt="cc" width="12" height="12">&nbsp;<img src="/assets/img/default/cc/by.svg" alt="by" width="12" height="12">&nbsp;<img src="/assets/img/default/cc/sa.svg" alt="sa" width="12" height="12">&nbsp;<p>Some rights reserved.</p>
            </a></div>
      <p class="footer-powered"><span>Pwrd by </span><a href="https://github.com/MrGreensWorkshop/MrGreen-JekyllTheme" target="_blank" rel="noopener noreferrer">Mr. Green</a></p>
    </footer>
  </div>
</div>
<div class="scroll-to-top-container">
        <a id="scroll-to-top" href="#main-wrapper" class="hover-effect"><i class="fa fa-angle-up"></i></a>
      </div></div>

    <div class="searchbox-container">
  <form id="searchbox-form" >
    <input type="search" id="search-box" placeholder="Search"
    onkeyup="if(this.value!==''){document.getElementById('search-results').style.display = 'block';}"
    onfocusout="this.value='';"
    onblur="setTimeout(function(){ document.getElementById('search-results').style.display = 'none'; }, 100);">
    <ul id="search-results" ></ul>
  </form>
</div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v0.4.1/dist/bootstrap-toc.min.js"></script>

<script src="/assets/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script>
      $('.imgViewer[data-no-image-viewer]').css("cursor", "unset");
      $(function () {
        $('.imgViewer:not([data-no-image-viewer])').magnificPopup({
          type: 'image'
          ,image: {
            titleSrc: 'alt'
            /* Error message */
            ,tError: 'The image could not be loaded.<br><br>%url%'
            /* Set to null to disable zoom out cursor. */
            /*,cursor: null */
          }
          ,closeOnContentClick: true
          ,showCloseBtn: false
          ,zoom: {
            /* By default it's false, so don't forget to enable it */
            enabled: true
            /* duration of the effect, in milliseconds */
            ,duration: 300
            /* CSS transition easing function */
            ,easing: 'ease-in-out'
          }
        });
      });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js"></script>
    <script>
      /* lazy loads elements with default selector as '.lozad' */
      const observer = lozad();
      observer.observe();
    </script>

<script>
      PagerPageNumbers.setProperties({
        paginatorListContainerName: ".pagination_wrapper .pagination"
        ,pageList: ["/posts/2022-03-03-Simple-linear-regression", "/posts/2022-01-13-Principle-of-inference", "/posts/2021-06-14-OneWay-ANOVA", "/posts/2020-02-07-ChiSquare-Distribution", "/posts/2019-11-01-Expected-value", "/posts/2019-07-01-Degree-of-freedom", "/posts/2018-12-02-Mean-N-Variance", "/posts/2018-06-22-Permutation-n-Combination"]
        ,firstButtonName: 'First'
        ,lastButtonName: 'Last'
        ,prevButtonName: "«"
        ,nextButtonName: "»"
      });
    </script>



<script src="/assets/js/simple-jekyll-search-1.9.2.min.js"></script><script>
  function loadSearch(jsonData, searchParam) {
    if (!jsonData) jsonData = '/query/search.json';
    var searchInput = document.getElementById('search-box');

    const simpleJekyllSearch = SimpleJekyllSearch({
      searchInput: searchInput
      ,resultsContainer: document.getElementById('search-results')
      ,json: jsonData
      ,searchResultTemplate: '<li><a href="{url}">{title}<span>{date}</span></a></li>'
      ,noResultsText: '<li>No results found.</li>'
      ,limit: 10
      ,fuzzy: false
    });

    if (searchParam) {
      searchInput.value = searchParam;
      searchInput.focus();
      searchInput.disabled=false;
      setTimeout(function(){
        simpleJekyllSearch.search(searchParam);
      }, 400);
    }
  }

  </script>

<script>
    function isEmpty(value) {
      if (value === "" || value === null || typeof value === "undefined") return true;
      return false;
    }

    function getQueryParam (param, mach = true) {
      var queryString = window.location.search.substring(1);
      if (isEmpty(queryString)) return null;
      var queries = queryString.split("&");
      for (var i in queries) {
        var pair = decodeURIComponent(queries[i]).split("=");
        if (mach == true){
          if (pair[0] == param) {
            if (isEmpty(pair[1]) === false) return pair[1];
          }
        }else{
          return pair;
        }
        break;
      }
      return null;
    }

    const searchParam = getQueryParam('search');

    (async () => {
      let resp = await fetch('/query/search.json');
      if (!resp.ok) return;
      let jsonData = await resp.json();
      loadSearch(jsonData, searchParam);
    })();
  </script>
<script>
  const disqus_consent_msg = true;
  var disqus_config = function () {
    this.language = "en";
    this.page.url = 'http://localhost:4000/posts/2020-02-07-ChiSquare-Distribution';
    this.page.identifier = '/posts/2020-02-07-ChiSquare-Distribution';
  };

  function disqusLoader() {
    var d = document, s = d.createElement('script');
    s.src = 'https://https-datachurnbyak-github-io.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }

  /* reload when data-color-scheme changes. (dark, light) */
  function disqusReloader() {
    if (typeof DISQUS === "undefined") return;
    DISQUS.reset({
      reload: true
      ,config: disqus_config
    });
  }
  const color_scheme_observer = new MutationObserver(disqusReloader);
  color_scheme_observer.observe(document.body, {attributeFilter: ["data-color-scheme"]});
  /* comments load mode */
  let discusLoadDoNotAskStorageKey = "disqusLoadDoNotAskAgain";

  function add_click_to_load_button() {
    if (localStorage.getItem(discusLoadDoNotAskStorageKey)) disqusLoader();

    /* create element */
    let newElement = document.createElement("div");

    if (disqus_consent_msg == true) {
      newElement.innerHTML = "<div class=\"multipurpose-container\" style=\"margin:20px\"> <h4 style=\"margin-top: 0;\">Comments (Disqus.com)</h4> <p> Comment feature is hosted by a third party. By showing the external content you accept the <a href=\"https://help.disqus.com/en/articles/1717102-terms-of-service\" target=\"_blank\" rel=\"noopener noreferrer\">Terms of Service</a> and <a href=\"https://help.disqus.com/en/articles/1717103-disqus-privacy-policy\" target=\"_blank\" rel=\"noopener noreferrer\">Privacy Policy</a> of disqus.com. <br>If you prefer to opt out of targeted advertising, open <a href=\"https://disqus.com/data-sharing-settings\" target=\"_blank\" rel=\"noopener noreferrer\">this link</a> and click \"opt-out\" button and close. Return here and load comments. </p> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority load_comments\" data-comment-always-load role=\"button\">Always show</a> &nbsp;<a href=\"javascript:void(0);\" class=\"btn-base load_comments\" role=\"button\">Show only this time</a> </div>";
    } else {
      newElement.innerHTML = '<a href="javascript:void(0);" class="btn-base load_comments" role="button">Load Comments</a>';
      newElement.style.textAlign = 'center';
      newElement.style.minHeight = '20px';
    }

    /* add button */
    let holder = document.querySelector('#disqus_thread');
    if (!holder) return;
    holder.appendChild(newElement);
    /* add button click event */
    let buttons = document.querySelectorAll('#disqus_thread .load_comments');
    if (!buttons) return;
    buttons.forEach(function (button) {
      button.addEventListener('click', buttonCallback);
    });

    function buttonCallback(e) {
      disqusLoader();
      /* scroll to page bottom to see comments. */
      document.getElementById('disqus_thread').style.height = '394px';
      window.scrollTo(0, document.body.scrollHeight);
      if (e.target.hasAttribute('data-comment-always-load')) {
        localStorage.setItem(discusLoadDoNotAskStorageKey, true);
      }
    };
  }
  /* load when slide to the end of page */
  window.addEventListener("load", add_click_to_load_button);
  </script>


    <script id="dsq-count-scr" src="https://https-datachurnbyak-github-io.disqus.com/count.js" async></script>
    <script>
        if (window.location.hash == "#disqus_thread") {
          let element = document.getElementById('disqus_thread');
          $("html, body").animate({ scrollTop: $(element).offset().top }, 600);
        }
      </script>
     


<script>
  CookieConsent.consentSettingHtml = "<h5>Cookie settings</h5> <br> <p class=\"info-text\">This website uses cookies to optimize site functionality. It will be activated with your approval. Please click each item below for cookie policy. Check <a href=\"/privacy-policy.html\">Privacy policy</a> </p> <table> <tr> <td onclick=\"$('.info[data-consent-info=necessary]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Strictly necessary cookies</p> </td> <td> <span class=\"active_text\">Always active</span></td> </tr> </table> <div class=\"info\" data-consent-info=\"necessary\"> <p>These cookies are essential for the website function and cannot be disable. They are usually set when site function like color scheme etc. is changed. These cookies do not store any personally identifiable information. Enables storage related to security such as authentication functionality, fraud prevention, and other user protection. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=analytics]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Performance cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" checked=\"checked\" data-consent=\"analytics\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"analytics\"> <p>Enables storage (such as cookies) related to analytics e.g. visit duration. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=preferences]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Functionality cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"preferences\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"preferences\"> <p>Enables storage that supports the functionality of the website or app e.g. language settings. Enables storage related to personalization e.g. video recommendations. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=advertising]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Targeting and advertising cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"advertising\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"advertising\"> <p>Enables storage (such as cookies) related to advertising. </p> </div> <br> <div class=\"button-holder\"> <a href=\"javascript:void(0);\" class=\"btn-base btn-left\" onclick=\"CookieConsent.consentSettingDone('deny');\" role=\"button\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentSettingDone('accept');\" role=\"button\">Allow all</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentSettingDone('save');\" role=\"button\">Allow selection</a> </div>";
  CookieConsent.consentBarHtml = "<div class=\"consent-bar\"> <a class=\"close-button\" href=\"javascript:void(0);\" onclick=\"CookieConsent.hideConsentBar();\"><i class=\"fa-fw fa fa-times\"></i></a> <p>This website uses cookies to optimize site functionality. It will be activated with your approval. Check <a href=\"/privacy-policy.html\">Privacy policy</a> </p> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('deny');\" role=\"button\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('settings');\" role=\"button\">Customize</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentBarDone('accept');\" role=\"button\">Allow all</a> </div>";
  CookieConsent.consent_items = JSON.parse('{"necessary":{"group":["security_storage"],"value":"granted","wait_for_update":500,"cookie_domain":"","no_check_box":true},"analytics":{"group":["analytics_storage"],"value":"denied"},"preferences":{"group":["functionality_storage","personalization_storage"],"value":"denied"},"advertising":{"group":["ad_storage"],"value":"denied"}}');
  CookieConsent.hideConsentBarWithSaveButton = true;

  const consent_settings = CookieConsent.getConsentSettings();
  const default_configs = JSON.parse('{"anonymize_ip":true,"ads_data_redaction":true,"cookie_flags":"SameSite=None;Secure"}');
</script>
</body>
</html>

